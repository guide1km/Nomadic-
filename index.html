<!DOCTYPE html><html lang="mn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nomadic App</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <main class="max-w-2xl mx-auto px-4 py-10 space-y-8"><!-- Title -->
<h1 class="text-3xl font-bold text-center text-blue-700">Nomadic Үнэлгээ & Сэтгэгдэл</h1>

<!-- Rating Section -->
<section id="rating-section" class="bg-white rounded-xl shadow p-6">
  <h2 class="text-xl font-semibold mb-4 text-center">Үнэлгээ өгөх</h2>
  <div id="rating-stars" class="flex justify-center gap-2 text-3xl cursor-pointer">
    <span data-star="1">☆</span>
    <span data-star="2">☆</span>
    <span data-star="3">☆</span>
    <span data-star="4">☆</span>
    <span data-star="5">☆</span>
  </div>
  <div class="mt-2 text-center text-gray-600">
    Үнэлгээ: <span id="rating-value">0.0</span>/5
  </div>
  <div class="space-y-1 mt-4 text-sm text-gray-700">
    <div class="flex items-center">
      <span class="w-5">5★</span>
      <div class="bg-gray-200 w-full h-2 mx-2 rounded">
        <div id="bar-5" class="bg-yellow-400 h-2 w-0"></div>
      </div>
      <span id="count-5">0</span>
    </div>
    <div class="flex items-center">
      <span class="w-5">4★</span>
      <div class="bg-gray-200 w-full h-2 mx-2 rounded">
        <div id="bar-4" class="bg-yellow-400 h-2 w-0"></div>
      </div>
      <span id="count-4">0</span>
    </div>
    <div class="flex items-center">
      <span class="w-5">3★</span>
      <div class="bg-gray-200 w-full h-2 mx-2 rounded">
        <div id="bar-3" class="bg-yellow-400 h-2 w-0"></div>
      </div>
      <span id="count-3">0</span>
    </div>
    <div class="flex items-center">
      <span class="w-5">2★</span>
      <div class="bg-gray-200 w-full h-2 mx-2 rounded">
        <div id="bar-2" class="bg-yellow-400 h-2 w-0"></div>
      </div>
      <span id="count-2">0</span>
    </div>
    <div class="flex items-center">
      <span class="w-5">1★</span>
      <div class="bg-gray-200 w-full h-2 mx-2 rounded">
        <div id="bar-1" class="bg-yellow-400 h-2 w-0"></div>
      </div>
      <span id="count-1">0</span>
    </div>
  </div>
</section>

<!-- Comment Section -->
<section id="comment-section" class="bg-white rounded-xl shadow p-6">
  <h2 class="text-xl font-semibold mb-4 text-center">Сэтгэгдэл үлдээх</h2>
  <form id="comment-form" class="space-y-3">
    <input id="comment-name" type="text" placeholder="Нэр..." class="w-full p-2 border rounded" required>
    <textarea id="comment-text" rows="3" placeholder="Сэтгэгдэл бичнэ үү..." class="w-full p-2 border rounded" required></textarea>
    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Илгээх</button>
  </form>
  <div id="comment-list" class="mt-4 space-y-2"></div>
</section>

  </main>  <script>
    const stars = document.querySelectorAll('#rating-stars span');
    const ratingValue = document.getElementById('rating-value');
    const counts = [0, 0, 0, 0, 0];
    let userRated = localStorage.getItem('userRated');
    let storedRatings = JSON.parse(localStorage.getItem("ratings") || "[]");

    function updateRatingBars(ratings) {
      const total = ratings.length;
      const sum = ratings.reduce((a, b) => a + b, 0);
      const avg = total ? (sum / total).toFixed(1) : "0.0";
      ratingValue.textContent = avg;
      [5,4,3,2,1].forEach((val, i) => {
        const count = ratings.filter(r => r === val).length;
        document.getElementById(`count-${val}`).textContent = count;
        document.getElementById(`bar-${val}`).style.width = total ? `${(count / total) * 100}%` : '0%';
      });
    }

    stars.forEach(star => {
      star.addEventListener('click', () => {
        if (userRated) return alert("Та аль хэдийн үнэлгээ өгсөн байна.");
        const rating = parseInt(star.getAttribute('data-star'));
        storedRatings.push(rating);
        localStorage.setItem('ratings', JSON.stringify(storedRatings));
        localStorage.setItem('userRated', true);
        updateRatingBars(storedRatings);
        stars.forEach((s, i) => {
          s.classList.toggle('text-yellow-400', i < rating);
        });
      });
    });
    updateRatingBars(storedRatings);

    // Comment
    const commentForm = document.getElementById('comment-form');
    const nameInput = document.getElementById('comment-name');
    const textInput = document.getElementById('comment-text');
    const commentList = document.getElementById('comment-list');
    const comments = JSON.parse(localStorage.getItem('comments') || "[]");

    function renderComments() {
      commentList.innerHTML = '';
      comments.forEach(c => {
        const div = document.createElement('div');
        div.className = 'p-2 border rounded bg-gray-50';
        div.innerHTML = `<strong>${c.name}</strong><p>${c.text}</p>`;
        commentList.appendChild(div);
      });
    }

    commentForm.addEventListener('submit', e => {
      e.preventDefault();
      const name = nameInput.value.trim();
      const text = textInput.value.trim();
      if (!name || !text) return;
      const comment = { name, text };
      comments.push(comment);
      localStorage.setItem('comments', JSON.stringify(comments));
      renderComments();
      commentForm.reset();
    });

    renderComments();
  </script></body>
</html>
